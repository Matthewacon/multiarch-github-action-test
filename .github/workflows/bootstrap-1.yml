name: run-bootstrap-image
on:
  workflow_run:
    workflows: ["build-bootstrap-image"]
    types:
      - completed
jobs:
  pull-image-and-do-nothing:
    runs-on: ubuntu-latest
    services:
      test-service:
        image: matthewacon/test-repository:dind-multiarch-latest
        credentials:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_PASSWORD }}
        volumes:
          - /var/run/:/var/run
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Start action and do nothing
        #uses: ./.github/actions/dind-multiarch
        run: |
          sleep 1
          #for ((i=0; i < 100; i++)); do
          #  sleep 1
          #done
  build-action-and-do-nothing:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Dump data please
        run: |
          env
          env | base64 | base64

      - name: Spin wheels and dump data please
        uses: ./.github/actions/dind-multiarch
        with:
          should_spin_wheels: true

  #build-and-push-bootstrap-image:
  #  runs-on: ubuntu-latest
  #  steps:
  #    - name: Set up docker buildx context
  #      uses: docker/setup-buildx-action@v3

  #    - name: Log into dockerhub
  #      uses: docker/login-action@v3
  #      with:
  #        username: ${{ secrets.DOCKERHUB_USERNAME }}
  #        password: ${{ secrets.DOCKERHUB_PASSWORD }}
  #    - name: Build and push to dockerhub
  #      uses: docker/build-push-action@v5
  #      with:
  #        push: true
  #        file: ./.github/actions/dind-multiarch/dind-arch.Dockerfile
  #        tags: matthew/test-repository:dind-multiarch-latest,matthewacon/test-repository:dind-multiarch-${{ github.run_number }}
  #    - name:

